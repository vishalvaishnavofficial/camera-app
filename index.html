<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Camera App</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/selfie_segmentation/selfie_segmentation.js"></script>
</head>
<body>

<div class="top-box">
    <div class="top-icons">
        <div class="top-icon-btn"><span class="material-symbols-outlined">settings</span></div>
        <div class="top-icon-btn" onclick="toggleFlash()">
            <span id="flashIcon" class="material-symbols-outlined">flash_off</span>
            <div id="flashLabel">Off</div>
        </div>
        <div class="top-icon-btn" onclick="toggleRatio()">
            <span class="material-symbols-outlined">aspect_ratio</span>
            <div id="ratioLabel">Full</div>
        </div>
    </div>
</div>

<div id="timer">00:00</div>

<div class="viewport-container">
    <div id="modeOverlay">
        <span id="overlayIcon" class="material-symbols-outlined">photo_camera</span>
        <div id="overlayText">Photo</div>
    </div>
    
    <div class="viewport" id="viewport">
        <video id="videoFeed" autoplay playsinline muted></video>
        <canvas id="portraitCanvas"></canvas>

        <div id="portraitSettingsBtn" class="portrait-settings-btn" onclick="toggleBlurSlider()">
            <span class="material-symbols-outlined">tune</span>
        </div>

        <div class="bottom-controls-area" id="bottomControlsArea">
            
            <div class="new-blur-container" id="newBlurContainer">
                <div class="blur-track">
                    <div class="blur-fill" id="blurFill" style="width: 15%;"></div>
                    <span class="blur-text" id="blurText">15%</span>
                </div>
                <input type="range" id="blurInput" min="0" max="50" value="15" class="invisible-slider">
            </div>

            <div class="zoom-area" id="zoomArea">
                <div class="needle"></div>
                <div class="zoom-pill" id="zoomPill">
                    <div class="dots-view">
                        <div class="zoom-dot" id="dot05" onclick="applyZoom(0.5)">.5x</div>
                        <div class="zoom-dot active" id="dot1" onclick="applyZoom(1)">1x</div>
                        <div class="zoom-dot" id="dot2" onclick="applyZoom(2)">2x</div>
                        <div class="zoom-dot" id="dot5" onclick="applyZoom(5)">5x</div>
                    </div>
                    <div class="ruler-view" id="rulerView">
                        <div class="ruler-track" id="rulerTrack"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="controls">
    <div class="mode-container">
        <div class="mode-track" id="modeTrack">
            <div class="mode-item" onclick="setMode(0, 'video')">Video</div>
            <div class="mode-item active" onclick="setMode(1, 'photo')">Photos</div>
            <div class="mode-item" onclick="setMode(2, 'portrait')">Portrait</div>
            <div class="mode-item" onclick="setMode(3, 'short')">Short Video</div>
            <div class="mode-item" onclick="setMode(4, 'slowmo')">Slowmo</div>
        </div>
    </div>
    <div class="shutter-row">
        <div class="gallery-circle" onclick="openViewer()">
            <img id="thumbImg" src="">
            <span id="galleryIcon" class="material-symbols-outlined" style="color:#666">image</span>
        </div>
        <div class="shutter-btn" id="shutter"></div>
        <div class="rotate-btn" id="rotateBtn" onclick="toggleCamera()"><span class="material-symbols-outlined">autorenew</span></div>
    </div>
</div>

<div class="viewer" id="viewer">
    <div class="viewer-header" onclick="closeViewer()"><span class="material-symbols-outlined">arrow_back</span></div>
    <div class="viewer-body" id="vBody"></div>
    <div class="viewer-footer"><button class="dl-btn" id="dlBtn"><span class="material-symbols-outlined">download</span> Download</button></div>
</div>

<canvas id="canvas" style="display:none;"></canvas>

<script src="script.js"></script>
</body>
        </html>
